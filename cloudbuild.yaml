steps:
  - id: "compile"
    name: "sandrokeil/typescript"
    args: 
      - tsc
  - id: "Make code bucket"
    name: gcr.io/cloud-builders/gsutil
    args: ["cb", "gs://${_PROJECT}-code/", "-p", "${_PROJECT}"]
  - id: "deploy index function"
    name: "gcr.io/cloud-builders/gcloud"
    args: ["functions", "deploy", "index", "--entry-point=test", "--project=${_PROJECT}", "--trigger-http"]
    dir: bin/web/
    waitFor: ["compile"]
substitutions:
    _PROJECT: open-contest-dev
